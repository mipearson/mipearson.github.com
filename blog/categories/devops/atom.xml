<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: devops | Michael Pearson]]></title>
  <link href="http://mipearson.github.com//blog/categories/devops/atom.xml" rel="self"/>
  <link href="http://mipearson.github.com//"/>
  <updated>2012-01-28T11:58:49+11:00</updated>
  <id>http://mipearson.github.com//</id>
  <author>
    <name><![CDATA[Michael Pearson]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Tracking Nginx Error Code Frequency with Munin]]></title>
    <link href="http://mipearson.github.com//blog/2011/08/16/nginx-error-codes/"/>
    <updated>2011-08-16T23:04:00+10:00</updated>
    <id>http://mipearson.github.com//blog/2011/08/16/nginx-error-codes</id>
    <content type="html"><![CDATA[<p>Place this in your <code>/etc/munin/plugins</code>.</p>

<p>You'll need to ensure that your <code>/var/nginx/access.log</code> is readable by your <code>munin-node</code> user.</p>

<script src="https://gist.github.com/1146151.js"> </script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linode to AWS in Sixty Minutes or Less]]></title>
    <link href="http://mipearson.github.com//blog/2011/08/08/linode-to-aws-in-sixty-minutes-or-less/"/>
    <updated>2011-08-08T23:14:00+10:00</updated>
    <id>http://mipearson.github.com//blog/2011/08/08/linode-to-aws-in-sixty-minutes-or-less</id>
    <content type="html"><![CDATA[<p>So, <a href="http://yfrog.com/kkrk4p">linode bailed</a> while I was in the middle of
working on the <a href="http://www.thebonscotts.com">band website</a>.</p>

<p>That annoyed me somewhat.</p>

<p>Here's what I did to move it off linode in under one hour:</p>

<ol>
<li>Logged in to my (already extant) AWS account</li>
<li>Created an elastic IP</li>
<li>Put in a request for a <code>t1.micro</code> spot instance in <code>ap-southeast-1</code> (have found it to have the least latency for .au clients)</li>
<li>Logged in to linode</li>
<li>Pointed the thebonscotts.com / www.thebonscotts.com A records to the new elastic IP</li>
<li>Waited ~5min for the spot instance to come up</li>
<li>Associated the elastic IP with the spot instance</li>
</ol>


<p>I then logged in to the instance, ran <code>ssh-keygen</code> to create a ssh
key, and added that key to my github project's deploy keyset.</p>

<p>I then ran these commands:</p>

<pre><code>sudo apt-get update
sudo apt-get install git-core
wget http://rubyenterpriseedition.googlecode.com/files/ruby-enterprise_1.8.7-2011.03_amd64_ubuntu10.04.deb
sudo dpkg --install ruby-enterprise_1.8.7-2011.03_amd64_ubuntu10.04.deb 
sudo gem update --system
sudo gem install bundler --no-rdoc --no-ri
sudo gem install passenger --no-rdoc --no-ri
sudo apt-get install apache2-prefork-dev
sudo apt-get install build-essential libcurl4-openssl-dev zlib1g-dev apache2-mpm-prefork
sudo /usr/local/bin/passenger-install-apache2-module
sudo vim /etc/apache2/sites-available/default

# above I copied in the sections from the passenger install
git clone git@github.com:&lt;REDACTED&gt;
sudo apt-get install memcached
sudo update-rc.d memcached defaults
sudo update-rc.d apache2 defaults
cd bonscotts/
bundle install
sudo /etc/init.d/apache2 restart
</code></pre>

<p>Easy!</p>

<p>Probably would have been easier if I'd had a puppet or chef recipe.</p>

<p>--</p>

<h3>Postscript</h3>

<p>I didn't create a snapshot of the instance. A month later, when the AWS spot instance price exceeded my maximum bid, the instance was terminated and I had to repeat the above process.</p>

<p>Fortunately I had the above instructions archived on <a href="http://gist.github.com">github</a>.</p>
]]></content>
  </entry>
  
</feed>
